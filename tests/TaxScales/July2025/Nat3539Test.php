<?php

namespace ManageIt\PaygTax\Tests\TaxScales\July2025;

use ManageIt\PaygTax\PaygTax;
use ManageIt\PaygTax\Tests\Fixtures\Earning;
use ManageIt\PaygTax\Tests\Fixtures\Payee;
use ManageIt\PaygTax\Tests\Fixtures\Payer;
use PHPUnit\Framework\TestCase;
use PHPUnit\Framework\Assert;

/**
 * @covers \ManageIt\PaygTax\TaxScales\Nat3539
 */
class Nat3539Test extends TestCase
{
    /**
     * @dataProvider weeklyData
     */
    public function testWeeklyWithholding(
        int $gross,
        float $scale1,
        float $scale2,
        float $scale3,
        float $scale5,
        float $scale6
    ): void {
        $payer = new Payer();

        $payee = new Payee();
        $payee->payCycle = Payee::PAY_CYCLE_WEEKLY;
        $payee->residencyStatus = Payee::RESIDENT;
        $payee->tfn = true;
        $payee->claimsTaxFreeThreshold = false;
        $payee->stsl = true;

        $earning = new Earning();
        $earning->date = new \DateTime('2025-07-15');
        $earning->gross = $gross;

        // Scale 1

        $payg = PaygTax::new()
            ->setPayer($payer)
            ->setPayee($payee)
            ->setEarning($earning);

        Assert::assertEquals($scale1, $payg->getTaxWithheldAmount());

        // Scale 2

        $payee->claimsTaxFreeThreshold = true;

        $payg = PaygTax::new()
            ->setPayer($payer)
            ->setPayee($payee)
            ->setEarning($earning);

        Assert::assertEquals($scale2, $payg->getTaxWithheldAmount());

        // Scale 3

        $payee->residencyStatus = Payee::FOREIGN_RESIDENT;

        $payg = PaygTax::new()
            ->setPayer($payer)
            ->setPayee($payee)
            ->setEarning($earning);

        Assert::assertEquals($scale3, $payg->getTaxWithheldAmount());

        // Scale 5

        $payee->residencyStatus = Payee::RESIDENT;
        $payee->medicareLevyExemption = Payee::MEDICARE_LEVY_EXEMPTION_FULL;

        $payg = PaygTax::new()
            ->setPayer($payer)
            ->setPayee($payee)
            ->setEarning($earning);

        Assert::assertEquals($scale5, $payg->getTaxWithheldAmount());

        // Scale 6

        $payee->medicareLevyExemption = Payee::MEDICARE_LEVY_EXEMPTION_HALF;

        $payg = PaygTax::new()
            ->setPayer($payer)
            ->setPayee($payee)
            ->setEarning($earning);

        Assert::assertEquals($scale6, $payg->getTaxWithheldAmount());
    }

    /**
     * @return array<int, array<int|float, int|float>>
     */
    public function weeklyData(): array
    {
        return [
            [116, 19.00, 0.00, 35.00, 0.00, 0.00],
            [117, 19.00, 0.00, 35.00, 0.00, 0.00],
            [149, 24.00, 0.00, 45.00, 0.00, 0.00],
            [150, 24.00, 0.00, 45.00, 0.00, 0.00],
            [249, 45.00, 0.00, 75.00, 0.00, 0.00],
            [250, 45.00, 0.00, 75.00, 0.00, 0.00],
            [360, 69.00, 0.00, 108.00, 0.00, 0.00],
            [361, 69.00, 0.00, 108.00, 0.00, 0.00],
            [370, 71.00, 2.00, 111.00, 2.00, 2.00],
            [371, 71.00, 2.00, 111.00, 2.00, 2.00],
            [499, 95.00, 22.00, 150.00, 22.00, 22.00],
            [500, 95.00, 22.00, 150.00, 22.00, 22.00],
            [514, 98.00, 26.00, 154.00, 25.00, 25.00],
            [515, 98.00, 26.00, 154.00, 25.00, 25.00],
            [624, 133.00, 55.00, 187.00, 42.00, 42.00],
            [625, 134.00, 55.00, 187.00, 42.00, 42.00],
            [720, 164.00, 72.00, 216.00, 58.00, 58.00],
            [721, 165.00, 72.00, 216.00, 58.00, 58.00],
            [728, 167.00, 73.00, 218.00, 59.00, 59.00],
            [729, 175.00, 74.00, 219.00, 59.00, 59.00],
            [842, 212.00, 95.00, 253.00, 78.00, 78.00],
            [843, 213.00, 95.00, 253.00, 78.00, 78.00],
            [865, 220.00, 99.00, 259.00, 82.00, 83.00],
            [866, 220.00, 100.00, 260.00, 82.00, 84.00],
            [895, 230.00, 109.00, 268.00, 91.00, 94.00],
            [896, 239.00, 109.00, 269.00, 91.00, 94.00],
            [931, 251.00, 121.00, 279.00, 102.00, 107.00],
            [932, 251.00, 121.00, 280.00, 102.00, 107.00],
            [970, 264.00, 133.00, 291.00, 114.00, 120.00],
            [971, 270.00, 134.00, 291.00, 114.00, 121.00],
            [1050, 297.00, 159.00, 315.00, 138.00, 148.00],
            [1051, 302.00, 159.00, 315.00, 138.00, 149.00],
            [1052, 303.00, 160.00, 316.00, 139.00, 149.00],
            [1053, 303.00, 160.00, 316.00, 139.00, 150.00],
            [1078, 312.00, 168.00, 323.00, 147.00, 157.00],
            [1079, 312.00, 179.00, 334.00, 158.00, 168.00],
            [1134, 332.00, 198.00, 352.00, 175.00, 186.00],
            [1135, 338.00, 198.00, 352.00, 175.00, 187.00],
            [1223, 369.00, 227.00, 379.00, 203.00, 215.00],
            [1224, 375.00, 228.00, 379.00, 203.00, 215.00],
            [1245, 383.00, 235.00, 386.00, 210.00, 222.00],
            [1246, 383.00, 247.00, 399.00, 222.00, 235.00],
            [1282, 396.00, 260.00, 410.00, 234.00, 247.00],
            [1317, 409.00, 272.00, 421.00, 245.00, 258.00],
            [1318, 416.00, 272.00, 422.00, 245.00, 259.00],
            [1320, 416.00, 273.00, 422.00, 246.00, 259.00],
            [1321, 417.00, 280.00, 429.00, 253.00, 266.00],
            [1323, 418.00, 280.00, 430.00, 254.00, 267.00],
            [1400, 446.00, 307.00, 455.00, 279.00, 293.00],
            [1401, 446.00, 314.00, 462.00, 286.00, 300.00],
            [1418, 459.00, 320.00, 468.00, 292.00, 306.00],
            [1484, 484.00, 343.00, 490.00, 313.00, 328.00],
            [1485, 484.00, 351.00, 498.00, 321.00, 336.00],
            [1523, 498.00, 364.00, 510.00, 334.00, 349.00],
            [1524, 506.00, 365.00, 511.00, 334.00, 350.00],
            [1573, 525.00, 382.00, 527.00, 351.00, 366.00],
            [1574, 525.00, 390.00, 535.00, 359.00, 375.00],
            [1636, 548.00, 413.00, 556.00, 380.00, 396.00],
            [1637, 557.00, 413.00, 557.00, 380.00, 397.00],
            [1667, 568.00, 424.00, 567.00, 391.00, 407.00],
            [1668, 568.00, 433.00, 576.00, 399.00, 416.00],
            [1755, 602.00, 464.00, 606.00, 429.00, 447.00],
            [1756, 611.00, 465.00, 606.00, 430.00, 447.00],
            [1767, 615.00, 469.00, 610.00, 433.00, 451.00],
            [1768, 615.00, 478.00, 619.00, 443.00, 460.00],
            [1844, 645.00, 506.00, 645.00, 469.00, 488.00],
            [1845, 645.00, 506.00, 646.00, 470.00, 488.00],
            [1873, 656.00, 517.00, 656.00, 479.00, 498.00],
            [1874, 656.00, 527.00, 665.00, 489.00, 508.00],
            [1882, 659.00, 530.00, 668.00, 492.00, 511.00],
            [1883, 669.00, 530.00, 669.00, 492.00, 511.00],
            [1986, 709.00, 569.00, 705.00, 529.00, 549.00],
            [1987, 710.00, 579.00, 715.00, 539.00, 559.00],
            [2015, 721.00, 589.00, 725.00, 549.00, 569.00],
            [2016, 731.00, 590.00, 726.00, 550.00, 570.00],
            [2105, 766.00, 624.00, 758.00, 582.00, 603.00],
            [2106, 767.00, 635.00, 769.00, 592.00, 614.00],
            [2119, 772.00, 640.00, 773.00, 597.00, 618.00],
            [2120, 772.00, 640.00, 774.00, 598.00, 619.00],
            [2157, 787.00, 654.00, 787.00, 611.00, 633.00],
            [2158, 798.00, 655.00, 788.00, 611.00, 633.00],
            [2232, 827.00, 683.00, 815.00, 638.00, 661.00],
            [2233, 828.00, 695.00, 826.00, 650.00, 672.00],
            [2245, 833.00, 699.00, 831.00, 654.00, 677.00],
            [2246, 833.00, 700.00, 831.00, 655.00, 677.00],
            [2308, 862.00, 724.00, 854.00, 678.00, 701.00],
            [2309, 874.00, 724.00, 854.00, 678.00, 701.00],
            [2365, 901.00, 746.00, 875.00, 699.00, 722.00],
            [2366, 901.00, 758.00, 887.00, 711.00, 735.00],
            [2468, 950.00, 799.00, 926.00, 749.00, 774.00],
            [2469, 963.00, 799.00, 926.00, 750.00, 774.00],
            [2490, 973.00, 807.00, 934.00, 758.00, 782.00],
            [2491, 973.00, 808.00, 934.00, 758.00, 783.00],
            [2507, 981.00, 814.00, 940.00, 764.00, 789.00],
            [2508, 981.00, 827.00, 953.00, 777.00, 802.00],
            [2595, 1023.00, 862.00, 986.00, 810.00, 836.00],
            [2596, 1024.00, 862.00, 987.00, 810.00, 836.00],
            [2637, 1043.00, 882.00, 1005.00, 829.00, 855.00],
            [2638, 1057.00, 882.00, 1006.00, 829.00, 856.00],
            [2652, 1064.00, 889.00, 1012.00, 836.00, 862.00],
            [2653, 1064.00, 889.00, 1013.00, 836.00, 863.00],
            [2658, 1067.00, 891.00, 1015.00, 838.00, 865.00],
            [2659, 1067.00, 905.00, 1029.00, 852.00, 879.00],
            [2736, 1104.00, 942.00, 1064.00, 887.00, 914.00],
            [2737, 1105.00, 942.00, 1064.00, 887.00, 915.00],
            [2816, 1143.00, 980.00, 1100.00, 923.00, 952.00],
            [2817, 1158.00, 980.00, 1100.00, 924.00, 952.00],
            [2818, 1158.00, 981.00, 1101.00, 924.00, 953.00],
            [2819, 1159.00, 995.00, 1115.00, 939.00, 967.00],
            [2898, 1198.00, 1033.00, 1152.00, 975.00, 1004.00],
            [2899, 1198.00, 1034.00, 1152.00, 976.00, 1005.00],
            [2987, 1241.00, 1076.00, 1193.00, 1016.00, 1046.00],
            [2988, 1242.00, 1091.00, 1208.00, 1032.00, 1061.00],
            [3166, 1329.00, 1178.00, 1291.00, 1114.00, 1146.00],
            [3167, 1329.00, 1194.00, 1307.00, 1131.00, 1162.00],
            [3302, 1396.00, 1260.00, 1371.00, 1194.00, 1227.00],
            [3303, 1396.00, 1261.00, 1371.00, 1195.00, 1228.00],
            [3652, 1595.00, 1432.00, 1535.00, 1359.00, 1395.00],
            [3653, 1596.00, 1432.00, 1536.00, 1359.00, 1396.00],
        ];
    }

    /**
     * @dataProvider fortnightlyData
     */
    public function testFortnightlyWithholding(
        int $gross,
        float $scale1,
        float $scale2,
        float $scale3,
        float $scale5,
        float $scale6
    ): void {
        $payer = new Payer();

        $payee = new Payee();
        $payee->payCycle = Payee::PAY_CYCLE_FORTNIGHTLY;
        $payee->residencyStatus = Payee::RESIDENT;
        $payee->tfn = true;
        $payee->claimsTaxFreeThreshold = false;
        $payee->stsl = true;

        $earning = new Earning();
        $earning->date = new \DateTime('2025-07-15');
        $earning->gross = $gross;

        // Scale 1

        $payg = PaygTax::new()
            ->setPayer($payer)
            ->setPayee($payee)
            ->setEarning($earning);

        Assert::assertEquals($scale1, $payg->getTaxWithheldAmount());

        // Scale 2

        $payee->claimsTaxFreeThreshold = true;

        $payg = PaygTax::new()
            ->setPayer($payer)
            ->setPayee($payee)
            ->setEarning($earning);

        Assert::assertEquals($scale2, $payg->getTaxWithheldAmount());

        // Scale 3

        $payee->residencyStatus = Payee::FOREIGN_RESIDENT;

        $payg = PaygTax::new()
            ->setPayer($payer)
            ->setPayee($payee)
            ->setEarning($earning);

        Assert::assertEquals($scale3, $payg->getTaxWithheldAmount());

        // Scale 5

        $payee->residencyStatus = Payee::RESIDENT;
        $payee->medicareLevyExemption = Payee::MEDICARE_LEVY_EXEMPTION_FULL;

        $payg = PaygTax::new()
            ->setPayer($payer)
            ->setPayee($payee)
            ->setEarning($earning);

        Assert::assertEquals($scale5, $payg->getTaxWithheldAmount());

        // Scale 6

        $payee->medicareLevyExemption = Payee::MEDICARE_LEVY_EXEMPTION_HALF;

        $payg = PaygTax::new()
            ->setPayer($payer)
            ->setPayee($payee)
            ->setEarning($earning);

        Assert::assertEquals($scale6, $payg->getTaxWithheldAmount());
    }

    /**
     * @return array<int, array<int|float, int|float>>
     */
    public function fortnightlyData(): array
    {
        return [
            [232, 38.00, 0.00, 70.00, 0.00, 0.00],
            [234, 38.00, 0.00, 70.00, 0.00, 0.00],
            [298, 48.00, 0.00, 90.00, 0.00, 0.00],
            [300, 48.00, 0.00, 90.00, 0.00, 0.00],
            [498, 90.00, 0.00, 150.00, 0.00, 0.00],
            [500, 90.00, 0.00, 150.00, 0.00, 0.00],
            [720, 138.00, 0.00, 216.00, 0.00, 0.00],
            [722, 138.00, 0.00, 216.00, 0.00, 0.00],
            [740, 142.00, 4.00, 222.00, 4.00, 4.00],
            [742, 142.00, 4.00, 222.00, 4.00, 4.00],
            [998, 190.00, 44.00, 300.00, 44.00, 44.00],
            [1000, 190.00, 44.00, 300.00, 44.00, 44.00],
            [1028, 196.00, 52.00, 308.00, 50.00, 50.00],
            [1030, 196.00, 52.00, 308.00, 50.00, 50.00],
            [1248, 266.00, 110.00, 374.00, 84.00, 84.00],
            [1250, 268.00, 110.00, 374.00, 84.00, 84.00],
            [1440, 328.00, 144.00, 432.00, 116.00, 116.00],
            [1442, 330.00, 144.00, 432.00, 116.00, 116.00],
            [1456, 334.00, 146.00, 436.00, 118.00, 118.00],
            [1458, 350.00, 148.00, 438.00, 118.00, 118.00],
            [1684, 424.00, 190.00, 506.00, 156.00, 156.00],
            [1686, 426.00, 190.00, 506.00, 156.00, 156.00],
            [1730, 440.00, 198.00, 518.00, 164.00, 166.00],
            [1732, 440.00, 200.00, 520.00, 164.00, 168.00],
            [1790, 460.00, 218.00, 536.00, 182.00, 188.00],
            [1792, 478.00, 218.00, 538.00, 182.00, 188.00],
            [1862, 502.00, 242.00, 558.00, 204.00, 214.00],
            [1864, 502.00, 242.00, 560.00, 204.00, 214.00],
            [1940, 528.00, 266.00, 582.00, 228.00, 240.00],
            [1942, 540.00, 268.00, 582.00, 228.00, 242.00],
            [2100, 594.00, 318.00, 630.00, 276.00, 296.00],
            [2102, 604.00, 318.00, 630.00, 276.00, 298.00],
            [2104, 606.00, 320.00, 632.00, 278.00, 298.00],
            [2106, 606.00, 320.00, 632.00, 278.00, 300.00],
            [2156, 624.00, 336.00, 646.00, 294.00, 314.00],
            [2158, 624.00, 358.00, 668.00, 316.00, 336.00],
            [2268, 664.00, 396.00, 704.00, 350.00, 372.00],
            [2270, 676.00, 396.00, 704.00, 350.00, 374.00],
            [2446, 738.00, 454.00, 758.00, 406.00, 430.00],
            [2448, 750.00, 456.00, 758.00, 406.00, 430.00],
            [2490, 766.00, 470.00, 772.00, 420.00, 444.00],
            [2492, 766.00, 494.00, 798.00, 444.00, 470.00],
            [2564, 792.00, 520.00, 820.00, 468.00, 494.00],
            [2634, 818.00, 544.00, 842.00, 490.00, 516.00],
            [2636, 832.00, 544.00, 844.00, 490.00, 518.00],
            [2640, 832.00, 546.00, 844.00, 492.00, 518.00],
            [2642, 834.00, 560.00, 858.00, 506.00, 532.00],
            [2646, 836.00, 560.00, 860.00, 508.00, 534.00],
            [2800, 892.00, 614.00, 910.00, 558.00, 586.00],
            [2802, 892.00, 628.00, 924.00, 572.00, 600.00],
            [2836, 918.00, 640.00, 936.00, 584.00, 612.00],
            [2968, 968.00, 686.00, 980.00, 626.00, 656.00],
            [2970, 968.00, 702.00, 996.00, 642.00, 672.00],
            [3046, 996.00, 728.00, 1020.00, 668.00, 698.00],
            [3048, 1012.00, 730.00, 1022.00, 668.00, 700.00],
            [3146, 1050.00, 764.00, 1054.00, 702.00, 732.00],
            [3148, 1050.00, 780.00, 1070.00, 718.00, 750.00],
            [3272, 1096.00, 826.00, 1112.00, 760.00, 792.00],
            [3274, 1114.00, 826.00, 1114.00, 760.00, 794.00],
            [3334, 1136.00, 848.00, 1134.00, 782.00, 814.00],
            [3336, 1136.00, 866.00, 1152.00, 798.00, 832.00],
            [3510, 1204.00, 928.00, 1212.00, 858.00, 894.00],
            [3512, 1222.00, 930.00, 1212.00, 860.00, 894.00],
            [3534, 1230.00, 938.00, 1220.00, 866.00, 902.00],
            [3536, 1230.00, 956.00, 1238.00, 886.00, 920.00],
            [3688, 1290.00, 1012.00, 1290.00, 938.00, 976.00],
            [3690, 1290.00, 1012.00, 1292.00, 940.00, 976.00],
            [3746, 1312.00, 1034.00, 1312.00, 958.00, 996.00],
            [3748, 1312.00, 1054.00, 1330.00, 978.00, 1016.00],
            [3764, 1318.00, 1060.00, 1336.00, 984.00, 1022.00],
            [3766, 1338.00, 1060.00, 1338.00, 984.00, 1022.00],
            [3972, 1418.00, 1138.00, 1410.00, 1058.00, 1098.00],
            [3974, 1420.00, 1158.00, 1430.00, 1078.00, 1118.00],
            [4030, 1442.00, 1178.00, 1450.00, 1098.00, 1138.00],
            [4032, 1462.00, 1180.00, 1452.00, 1100.00, 1140.00],
            [4210, 1532.00, 1248.00, 1516.00, 1164.00, 1206.00],
            [4212, 1534.00, 1270.00, 1538.00, 1184.00, 1228.00],
            [4238, 1544.00, 1280.00, 1546.00, 1194.00, 1236.00],
            [4240, 1544.00, 1280.00, 1548.00, 1196.00, 1238.00],
            [4314, 1574.00, 1308.00, 1574.00, 1222.00, 1266.00],
            [4316, 1596.00, 1310.00, 1576.00, 1222.00, 1266.00],
            [4464, 1654.00, 1366.00, 1630.00, 1276.00, 1322.00],
            [4466, 1656.00, 1390.00, 1652.00, 1300.00, 1344.00],
            [4490, 1666.00, 1398.00, 1662.00, 1308.00, 1354.00],
            [4492, 1666.00, 1400.00, 1662.00, 1310.00, 1354.00],
            [4616, 1724.00, 1448.00, 1708.00, 1356.00, 1402.00],
            [4618, 1748.00, 1448.00, 1708.00, 1356.00, 1402.00],
            [4730, 1802.00, 1492.00, 1750.00, 1398.00, 1444.00],
            [4732, 1802.00, 1516.00, 1774.00, 1422.00, 1470.00],
            [4936, 1900.00, 1598.00, 1852.00, 1498.00, 1548.00],
            [4938, 1926.00, 1598.00, 1852.00, 1500.00, 1548.00],
            [4980, 1946.00, 1614.00, 1868.00, 1516.00, 1564.00],
            [4982, 1946.00, 1616.00, 1868.00, 1516.00, 1566.00],
            [5014, 1962.00, 1628.00, 1880.00, 1528.00, 1578.00],
            [5016, 1962.00, 1654.00, 1906.00, 1554.00, 1604.00],
            [5190, 2046.00, 1724.00, 1972.00, 1620.00, 1672.00],
            [5192, 2048.00, 1724.00, 1974.00, 1620.00, 1672.00],
            [5274, 2086.00, 1764.00, 2010.00, 1658.00, 1710.00],
            [5276, 2114.00, 1764.00, 2012.00, 1658.00, 1712.00],
            [5304, 2128.00, 1778.00, 2024.00, 1672.00, 1724.00],
            [5306, 2128.00, 1778.00, 2026.00, 1672.00, 1726.00],
            [5316, 2134.00, 1782.00, 2030.00, 1676.00, 1730.00],
            [5318, 2134.00, 1810.00, 2058.00, 1704.00, 1758.00],
            [5472, 2208.00, 1884.00, 2128.00, 1774.00, 1828.00],
            [5474, 2210.00, 1884.00, 2128.00, 1774.00, 1830.00],
            [5632, 2286.00, 1960.00, 2200.00, 1846.00, 1904.00],
            [5634, 2316.00, 1960.00, 2200.00, 1848.00, 1904.00],
            [5636, 2316.00, 1962.00, 2202.00, 1848.00, 1906.00],
            [5638, 2318.00, 1990.00, 2230.00, 1878.00, 1934.00],
            [5796, 2396.00, 2066.00, 2304.00, 1950.00, 2008.00],
            [5798, 2396.00, 2068.00, 2304.00, 1952.00, 2010.00],
            [5974, 2482.00, 2152.00, 2386.00, 2032.00, 2092.00],
            [5976, 2484.00, 2182.00, 2416.00, 2064.00, 2122.00],
            [6332, 2658.00, 2356.00, 2582.00, 2228.00, 2292.00],
            [6334, 2658.00, 2388.00, 2614.00, 2262.00, 2324.00],
            [6604, 2792.00, 2520.00, 2742.00, 2388.00, 2454.00],
            [6606, 2792.00, 2522.00, 2742.00, 2390.00, 2456.00],
            [7304, 3190.00, 2864.00, 3070.00, 2718.00, 2790.00],
            [7306, 3192.00, 2864.00, 3072.00, 2718.00, 2792.00],
        ];
    }

    /**
     * @dataProvider monthlyData
     */
    public function testMonthlyWithholding(
        float $gross,
        float $scale1,
        float $scale2,
        float $scale3,
        float $scale5,
        float $scale6
    ): void {
        $payer = new Payer();

        $payee = new Payee();
        $payee->payCycle = Payee::PAY_CYCLE_MONTHLY;
        $payee->residencyStatus = Payee::RESIDENT;
        $payee->tfn = true;
        $payee->claimsTaxFreeThreshold = false;
        $payee->stsl = true;

        $earning = new Earning();
        $earning->date = new \DateTime('2025-07-15');
        $earning->gross = $gross;

        // Scale 1

        $payg = PaygTax::new()
            ->setPayer($payer)
            ->setPayee($payee)
            ->setEarning($earning);

        Assert::assertEquals($scale1, $payg->getTaxWithheldAmount());

        // Scale 2

        $payee->claimsTaxFreeThreshold = true;

        $payg = PaygTax::new()
            ->setPayer($payer)
            ->setPayee($payee)
            ->setEarning($earning);

        Assert::assertEquals($scale2, $payg->getTaxWithheldAmount());

        // Scale 3

        $payee->residencyStatus = Payee::FOREIGN_RESIDENT;

        $payg = PaygTax::new()
            ->setPayer($payer)
            ->setPayee($payee)
            ->setEarning($earning);

        Assert::assertEquals($scale3, $payg->getTaxWithheldAmount());

        // Scale 5

        $payee->residencyStatus = Payee::RESIDENT;
        $payee->medicareLevyExemption = Payee::MEDICARE_LEVY_EXEMPTION_FULL;

        $payg = PaygTax::new()
            ->setPayer($payer)
            ->setPayee($payee)
            ->setEarning($earning);

        Assert::assertEquals($scale5, $payg->getTaxWithheldAmount());

        // Scale 6

        $payee->medicareLevyExemption = Payee::MEDICARE_LEVY_EXEMPTION_HALF;

        $payg = PaygTax::new()
            ->setPayer($payer)
            ->setPayee($payee)
            ->setEarning($earning);

        Assert::assertEquals($scale6, $payg->getTaxWithheldAmount());
    }

    /**
     * @return array<int, array<int|float, int|float>>
     */
    public function monthlyData(): array
    {
        return [
            [502.67, 82.00, 0.00, 152.00, 0.00, 0.00],
            [507.00, 82.00, 0.00, 152.00, 0.00, 0.00],
            [645.67, 104.00, 0.00, 195.00, 0.00, 0.00],
            [650.00, 104.00, 0.00, 195.00, 0.00, 0.00],
            [1079.00, 195.00, 0.00, 325.00, 0.00, 0.00],
            [1083.33, 195.00, 0.00, 325.00, 0.00, 0.00],
            [1560.00, 299.00, 0.00, 468.00, 0.00, 0.00],
            [1564.33, 299.00, 0.00, 468.00, 0.00, 0.00],
            [1603.33, 308.00, 9.00, 481.00, 9.00, 9.00],
            [1607.67, 308.00, 9.00, 481.00, 9.00, 9.00],
            [2162.33, 412.00, 95.00, 650.00, 95.00, 95.00],
            [2166.67, 412.00, 95.00, 650.00, 95.00, 95.00],
            [2227.33, 425.00, 113.00, 667.00, 108.00, 108.00],
            [2231.67, 425.00, 113.00, 667.00, 108.00, 108.00],
            [2704.00, 576.00, 238.00, 810.00, 182.00, 182.00],
            [2708.33, 581.00, 238.00, 810.00, 182.00, 182.00],
            [3120.00, 711.00, 312.00, 936.00, 251.00, 251.00],
            [3124.33, 715.00, 312.00, 936.00, 251.00, 251.00],
            [3154.67, 724.00, 316.00, 945.00, 256.00, 256.00],
            [3159.00, 758.00, 321.00, 949.00, 256.00, 256.00],
            [3648.67, 919.00, 412.00, 1096.00, 338.00, 338.00],
            [3653.00, 923.00, 412.00, 1096.00, 338.00, 338.00],
            [3748.33, 953.00, 429.00, 1122.00, 355.00, 360.00],
            [3752.67, 953.00, 433.00, 1127.00, 355.00, 364.00],
            [3878.33, 997.00, 472.00, 1161.00, 394.00, 407.00],
            [3882.67, 1036.00, 472.00, 1166.00, 394.00, 407.00],
            [4034.33, 1088.00, 524.00, 1209.00, 442.00, 464.00],
            [4038.67, 1088.00, 524.00, 1213.00, 442.00, 464.00],
            [4203.33, 1144.00, 576.00, 1261.00, 494.00, 520.00],
            [4207.67, 1170.00, 581.00, 1261.00, 494.00, 524.00],
            [4550.00, 1287.00, 689.00, 1365.00, 598.00, 641.00],
            [4554.33, 1309.00, 689.00, 1365.00, 598.00, 646.00],
            [4558.67, 1313.00, 693.00, 1369.00, 602.00, 646.00],
            [4563.00, 1313.00, 693.00, 1369.00, 602.00, 650.00],
            [4671.33, 1352.00, 728.00, 1400.00, 637.00, 680.00],
            [4675.67, 1352.00, 776.00, 1447.00, 685.00, 728.00],
            [4914.00, 1439.00, 858.00, 1525.00, 758.00, 806.00],
            [4918.33, 1465.00, 858.00, 1525.00, 758.00, 810.00],
            [5299.67, 1599.00, 984.00, 1642.00, 880.00, 932.00],
            [5304.00, 1625.00, 988.00, 1642.00, 880.00, 932.00],
            [5395.00, 1660.00, 1018.00, 1673.00, 910.00, 962.00],
            [5399.33, 1660.00, 1070.00, 1729.00, 962.00, 1018.00],
            [5555.33, 1716.00, 1127.00, 1777.00, 1014.00, 1070.00],
            [5707.00, 1772.00, 1179.00, 1824.00, 1062.00, 1118.00],
            [5711.33, 1803.00, 1179.00, 1829.00, 1062.00, 1122.00],
            [5720.00, 1803.00, 1183.00, 1829.00, 1066.00, 1122.00],
            [5724.33, 1807.00, 1213.00, 1859.00, 1096.00, 1153.00],
            [5733.00, 1811.00, 1213.00, 1863.00, 1101.00, 1157.00],
            [6066.67, 1933.00, 1330.00, 1972.00, 1209.00, 1270.00],
            [6071.00, 1933.00, 1361.00, 2002.00, 1239.00, 1300.00],
            [6144.67, 1989.00, 1387.00, 2028.00, 1265.00, 1326.00],
            [6430.67, 2097.00, 1486.00, 2123.00, 1356.00, 1421.00],
            [6435.00, 2097.00, 1521.00, 2158.00, 1391.00, 1456.00],
            [6599.67, 2158.00, 1577.00, 2210.00, 1447.00, 1512.00],
            [6604.00, 2193.00, 1582.00, 2214.00, 1447.00, 1517.00],
            [6816.33, 2275.00, 1655.00, 2284.00, 1521.00, 1586.00],
            [6820.67, 2275.00, 1690.00, 2318.00, 1556.00, 1625.00],
            [7089.33, 2375.00, 1790.00, 2409.00, 1647.00, 1716.00],
            [7093.67, 2414.00, 1790.00, 2414.00, 1647.00, 1720.00],
            [7223.67, 2461.00, 1837.00, 2457.00, 1694.00, 1764.00],
            [7228.00, 2461.00, 1876.00, 2496.00, 1729.00, 1803.00],
            [7605.00, 2609.00, 2011.00, 2626.00, 1859.00, 1937.00],
            [7609.33, 2648.00, 2015.00, 2626.00, 1863.00, 1937.00],
            [7657.00, 2665.00, 2032.00, 2643.00, 1876.00, 1954.00],
            [7661.33, 2665.00, 2071.00, 2682.00, 1920.00, 1993.00],
            [7990.67, 2795.00, 2193.00, 2795.00, 2032.00, 2115.00],
            [7995.00, 2795.00, 2193.00, 2799.00, 2037.00, 2115.00],
            [8116.33, 2843.00, 2240.00, 2843.00, 2076.00, 2158.00],
            [8120.67, 2843.00, 2284.00, 2882.00, 2119.00, 2201.00],
            [8155.33, 2856.00, 2297.00, 2895.00, 2132.00, 2214.00],
            [8159.67, 2899.00, 2297.00, 2899.00, 2132.00, 2214.00],
            [8606.00, 3072.00, 2466.00, 3055.00, 2292.00, 2379.00],
            [8610.33, 3077.00, 2509.00, 3098.00, 2336.00, 2422.00],
            [8731.67, 3124.00, 2552.00, 3142.00, 2379.00, 2466.00],
            [8736.00, 3168.00, 2557.00, 3146.00, 2383.00, 2470.00],
            [9121.67, 3319.00, 2704.00, 3285.00, 2522.00, 2613.00],
            [9126.00, 3324.00, 2752.00, 3332.00, 2565.00, 2661.00],
            [9182.33, 3345.00, 2773.00, 3350.00, 2587.00, 2678.00],
            [9186.67, 3345.00, 2773.00, 3354.00, 2591.00, 2682.00],
            [9347.00, 3410.00, 2834.00, 3410.00, 2648.00, 2743.00],
            [9351.33, 3458.00, 2838.00, 3415.00, 2648.00, 2743.00],
            [9672.00, 3584.00, 2960.00, 3532.00, 2765.00, 2864.00],
            [9676.33, 3588.00, 3012.00, 3579.00, 2817.00, 2912.00],
            [9728.33, 3610.00, 3029.00, 3601.00, 2834.00, 2934.00],
            [9732.67, 3610.00, 3033.00, 3601.00, 2838.00, 2934.00],
            [10001.33, 3735.00, 3137.00, 3701.00, 2938.00, 3038.00],
            [10005.67, 3787.00, 3137.00, 3701.00, 2938.00, 3038.00],
            [10248.33, 3904.00, 3233.00, 3792.00, 3029.00, 3129.00],
            [10252.67, 3904.00, 3285.00, 3844.00, 3081.00, 3185.00],
            [10694.67, 4117.00, 3462.00, 4013.00, 3246.00, 3354.00],
            [10699.00, 4173.00, 3462.00, 4013.00, 3250.00, 3354.00],
            [10790.00, 4216.00, 3497.00, 4047.00, 3285.00, 3389.00],
            [10794.33, 4216.00, 3501.00, 4047.00, 3285.00, 3393.00],
            [10863.67, 4251.00, 3527.00, 4073.00, 3311.00, 3419.00],
            [10868.00, 4251.00, 3584.00, 4130.00, 3367.00, 3475.00],
            [11245.00, 4433.00, 3735.00, 4273.00, 3510.00, 3623.00],
            [11249.33, 4437.00, 3735.00, 4277.00, 3510.00, 3623.00],
            [11427.00, 4520.00, 3822.00, 4355.00, 3592.00, 3705.00],
            [11431.33, 4580.00, 3822.00, 4359.00, 3592.00, 3709.00],
            [11492.00, 4611.00, 3852.00, 4385.00, 3623.00, 3735.00],
            [11496.33, 4611.00, 3852.00, 4390.00, 3623.00, 3740.00],
            [11518.00, 4624.00, 3861.00, 4398.00, 3631.00, 3748.00],
            [11522.33, 4624.00, 3922.00, 4459.00, 3692.00, 3809.00],
            [11856.00, 4784.00, 4082.00, 4611.00, 3844.00, 3961.00],
            [11860.33, 4788.00, 4082.00, 4611.00, 3844.00, 3965.00],
            [12202.67, 4953.00, 4247.00, 4767.00, 4000.00, 4125.00],
            [12207.00, 5018.00, 4247.00, 4767.00, 4004.00, 4125.00],
            [12211.33, 5018.00, 4251.00, 4771.00, 4004.00, 4130.00],
            [12215.67, 5022.00, 4312.00, 4832.00, 4069.00, 4190.00],
            [12558.00, 5191.00, 4476.00, 4992.00, 4225.00, 4351.00],
            [12562.33, 5191.00, 4481.00, 4992.00, 4229.00, 4355.00],
            [12943.67, 5378.00, 4663.00, 5170.00, 4403.00, 4533.00],
            [12948.00, 5382.00, 4728.00, 5235.00, 4472.00, 4598.00],
            [13719.33, 5759.00, 5105.00, 5594.00, 4827.00, 4966.00],
            [13723.67, 5759.00, 5174.00, 5664.00, 4901.00, 5035.00],
            [14308.67, 6049.00, 5460.00, 5941.00, 5174.00, 5317.00],
            [14313.00, 6049.00, 5464.00, 5941.00, 5178.00, 5321.00],
            [15825.33, 6912.00, 6205.00, 6652.00, 5889.00, 6045.00],
            [15829.67, 6916.00, 6205.00, 6656.00, 5889.00, 6049.00],
        ];
    }
}
